<!DOCTYPE html>
<html>
<head>
    <title>TEST INLINE - No External Files</title>
    <style>
        body { font-family: monospace; margin: 20px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>TEST INLINE - Everything in One File</h1>
    <div id="output"></div>
    
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <script>
        const output = document.getElementById('output');
        
        function log(msg, isError = false) {
            const p = document.createElement('p');
            p.className = isError ? 'error' : 'success';
            p.textContent = msg;
            output.appendChild(p);
            console.log(msg);
        }
        
        async function test() {
            try {
                log('Loading Pyodide...');
                const pyodide = await loadPyodide();
                log('✓ Pyodide loaded');
                
                log('Loading NumPy...');
                await pyodide.loadPackage(['numpy']);
                log('✓ NumPy loaded');
                
                log('Testing simple Python...');
                pyodide.runPython(`
import numpy as np
print("NumPy imported successfully")
x = np.array([1, 2, 3])
print(f"Array created: {x}")
                `);
                log('✓ Simple Python works');
                
                log('Defining a simple function...');
                pyodide.runPython(`
def simple_function(x):
    return x * 2

result = simple_function(21)
print(f"Function result: {result}")
                `);
                log('✓ Function definition works');
                
                log('Testing class definition...');
                pyodide.runPython(`
class TestClass:
    def __init__(self):
        self.value = 42
    
    def get_value(self):
        return self.value

obj = TestClass()
print(f"Class instance value: {obj.get_value()}")
                `);
                log('✓ Class definition works');
                
                log('Testing function that uses NumPy...');
                pyodide.runPython(`
def numpy_function():
    import numpy as np
    arr = np.array([[1, 2], [3, 4]])
    return np.sum(arr)

total = numpy_function()
print(f"NumPy function result: {total}")
                `);
                log('✓ NumPy in function works');
                
                log('ALL INLINE TESTS PASSED!');
                
            } catch (error) {
                log(`ERROR: ${error.message}`, true);
                console.error(error);
            }
        }
        
        test();
    </script>
</body>
</html>